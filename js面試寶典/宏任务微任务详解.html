<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡è¯¦è§£ - æŒæ¡æ‰§è¡Œé¡ºåº</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        h2 {
            color: #4CAF50;
            margin-top: 30px;
        }
        h3 {
            color: #666;
            margin-top: 20px;
        }
        .key-point {
            background: #fffacd;
            padding: 15px;
            border-left: 4px solid #ffd700;
            margin: 15px 0;
        }
        .code-block {
            background: #f8f8f8;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            overflow-x: auto;
        }
        .output {
            background: #e8f5e9;
            border-left: 4px solid #4CAF50;
            padding: 15px;
            margin: 10px 0;
        }
        .step {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 10px;
            margin: 8px 0;
        }
        .warning {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 15px 0;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        button:hover {
            background: #45a049;
        }
        .example {
            margin: 20px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 4px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #4CAF50;
            color: white;
        }
        tr:nth-child(even) {
            background: #f9f9f9;
        }
        .practice-btn {
            background: #2196F3;
        }
        .practice-btn:hover {
            background: #1976D2;
        }
    </style>
</head>
<body>
    <h1>ğŸ¯ JavaScript å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡ - å®Œå…¨æŒæ¡æŒ‡å—</h1>
    
    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; margin: 20px 0; border-radius: 8px; text-align: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);">
        <p style="color: #fff; font-size: 18px; margin: 0 0 10px 0; font-weight: bold;">ğŸ’¬ æ¬¢è¿æ·»åŠ æˆ‘çš„å¾®ä¿¡ï¼Œä¸€èµ·äº¤æµå­¦ä¹ ï¼</p>
        <p style="color: #ffeb3b; font-size: 24px; margin: 0; font-weight: bold; letter-spacing: 2px;">ğŸ“± å¾®ä¿¡å·ï¼šLydia_web_developer1</p>
    </div>

    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 20px; margin: 20px 0; border-radius: 8px; text-align: center; box-shadow: 0 4px 15px rgba(245, 87, 108, 0.4);">
        <p style="color: #fff; font-size: 18px; margin: 0 0 10px 0; font-weight: bold;">â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘çš„GitHubç‚¹ä¸ªStarï¼</p>
        <p style="color: #fff; font-size: 20px; margin: 10px 0 0 0;">
            <a href="https://github.com/somanwai08/interviewtips" target="_blank" style="color: #ffeb3b; text-decoration: none; font-weight: bold; font-size: 22px; border: 2px solid #ffeb3b; padding: 10px 25px; border-radius: 25px; display: inline-block; transition: all 0.3s;" onmouseover="this.style.background='#ffeb3b'; this.style.color='#f5576c';" onmouseout="this.style.background='transparent'; this.style.color='#ffeb3b';">
                ğŸŒŸ GitHub: somanwai08/interviewtips
            </a>
        </p>
    </div>

    <div class="section">
        <h2>ğŸ“š ä¸€ã€æ ¸å¿ƒæ¦‚å¿µé€Ÿè®°</h2>
        
        <div class="key-point">
            <h3>ğŸ”‘ è®°ä½è¿™ä¸ªæ‰§è¡Œé¡ºåºå£è¯€ï¼š</h3>
            <strong style="font-size: 18px; color: #d32f2f;">
                åŒæ­¥ â†’ å¾®ä»»åŠ¡ â†’ å®ä»»åŠ¡<br>
                (Sync â†’ Microtask â†’ Macrotask)
            </strong>
        </div>

        <h3>å¸¸è§ä»»åŠ¡åˆ†ç±»è¡¨ï¼š</h3>
        <table>
            <thead>
                <tr>
                    <th>ç±»å‹</th>
                    <th>ä»»åŠ¡</th>
                    <th>è®°å¿†æŠ€å·§</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>åŒæ­¥ä»»åŠ¡</strong></td>
                    <td>console.log()ã€æ™®é€šä»£ç ã€async å‡½æ•°è°ƒç”¨ã€await è¡¨è¾¾å¼æœ¬èº«ã€await å‰é¢çš„ä»£ç </td>
                    <td>ç«‹å³æ‰§è¡Œï¼Œä¸ç­‰å¾…</td>
                </tr>
                <tr>
                    <td rowspan="4"><strong>å¾®ä»»åŠ¡ (Microtask)</strong></td>
                    <td>Promise.then()</td>
                    <td rowspan="4">Promiseç›¸å…³ã€MutationObserver<br><strong>ä¼˜å…ˆçº§é«˜</strong></td>
                </tr>
                <tr>
                    <td>Promise.catch()</td>
                </tr>
                <tr>
                    <td>Promise.finally()</td>
                </tr>
                <tr>
                    <td>await åé¢çš„ä»£ç ã€MutationObserver</td>
                </tr>
                <tr>
                    <td rowspan="4"><strong>å®ä»»åŠ¡ (Macrotask)</strong></td>
                    <td>setTimeout()</td>
                    <td rowspan="4">å®šæ—¶å™¨ã€I/Oæ“ä½œ<br><strong>ä¼˜å…ˆçº§ä½</strong></td>
                </tr>
                <tr>
                    <td>setInterval()</td>
                </tr>
                <tr>
                    <td>setImmediate() (Node.js)</td>
                </tr>
                <tr>
                    <td>I/Oæ“ä½œã€UIæ¸²æŸ“</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="section">
        <h2>ğŸ“ äºŒã€Event Loop äº‹ä»¶å¾ªç¯æœºåˆ¶</h2>
        
        <div class="key-point">
            <h3>æ‰§è¡Œæµç¨‹ï¼ˆæ­»è®°ç¡¬èƒŒè¿™5æ­¥ï¼‰ï¼š</h3>
            <div class="step">1ï¸âƒ£ æ‰§è¡Œ<strong>æ‰€æœ‰åŒæ­¥ä»£ç </strong>ï¼ˆä¸»çº¿ç¨‹ä»£ç ï¼‰</div>
            <div class="step">2ï¸âƒ£ åŒæ­¥ä»£ç æ‰§è¡Œå®Œåï¼Œæ£€æŸ¥<strong>å¾®ä»»åŠ¡é˜Ÿåˆ—</strong></div>
            <div class="step">3ï¸âƒ£ æ‰§è¡Œ<strong>æ‰€æœ‰å¾®ä»»åŠ¡</strong>ï¼ˆæ¸…ç©ºå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼‰</div>
            <div class="step">4ï¸âƒ£ æ‰§è¡Œ<strong>ä¸€ä¸ªå®ä»»åŠ¡</strong>ï¼ˆä»å®ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªï¼‰</div>
            <div class="step">5ï¸âƒ£ é‡å¤æ­¥éª¤2-4ï¼ˆå›åˆ°æ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼‰</div>
        </div>

        <div class="key-point" style="background: #e3f2fd; border-left: 4px solid #2196F3;">
            <h3>ğŸ“ Event Loop Execution Flow (For English Interviews):</h3>
            <div class="step" style="background: white;">
                <strong>Step 1:</strong> Execute <strong>all synchronous code</strong> in the call stack
            </div>
            <div class="step" style="background: white;">
                <strong>Step 2:</strong> Once the call stack is empty, <strong>check the microtask queue</strong>
            </div>
            <div class="step" style="background: white;">
                <strong>Step 3:</strong> Execute <strong>all microtasks</strong> until the microtask queue is empty
            </div>
            <div class="step" style="background: white;">
                <strong>Step 4:</strong> Execute <strong>one macrotask</strong> from the macrotask queue
            </div>
            <div class="step" style="background: white;">
                <strong>Step 5:</strong> Repeat steps 2-4 (go back to check microtask queue)
            </div>
            
            <div style="margin-top: 15px; padding: 10px; background: #fff3e0; border-radius: 4px;">
                <strong>ğŸ’¬ Interview Answer Template:</strong>
                <p style="margin: 10px 0; line-height: 1.6;">
                    "The Event Loop is JavaScript's mechanism for handling asynchronous operations. 
                    Here's how it works: First, all synchronous code executes on the call stack. 
                    When the stack is empty, the Event Loop checks the microtask queue and executes 
                    all microtasks (like Promise callbacks). After clearing the microtask queue, 
                    it takes one macrotask from the macrotask queue (like setTimeout), executes it, 
                    and then repeats the process. This ensures microtasks always have higher priority 
                    than macrotasks."
                </p>
            </div>
        </div>

        <div class="warning">
            <strong>âš ï¸ æ³¨æ„ï¼š</strong>
            <ul>
                <li>å¾®ä»»åŠ¡é˜Ÿåˆ—ä¼š<strong>ä¸€æ¬¡æ€§æ¸…ç©º</strong>ï¼ˆæ‰§è¡Œå®Œæ‰€æœ‰å¾®ä»»åŠ¡ï¼‰</li>
                <li>å®ä»»åŠ¡é˜Ÿåˆ—<strong>æ¯æ¬¡åªæ‰§è¡Œä¸€ä¸ª</strong>ï¼Œæ‰§è¡Œå®Œåå†æ£€æŸ¥å¾®ä»»åŠ¡</li>
                <li>Promiseæ„é€ å‡½æ•°å†…çš„ä»£ç æ˜¯<strong>åŒæ­¥æ‰§è¡Œ</strong>çš„</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ’¡ ä¸‰ã€å…¸å‹ä¾‹é¢˜è§£æ</h2>

        <!-- ä¾‹é¢˜1 -->
        <div class="example">
            <h3>ä¾‹é¢˜1ï¼šåŸºç¡€é¢˜ï¼ˆå¿…é¡»æŒæ¡ï¼‰</h3>
            <div class="code-block">
<pre>console.log('1');

setTimeout(() => {
    console.log('2');
}, 0);

Promise.resolve().then(() => {
    console.log('3');
});

console.log('4');</pre>
            </div>
            <button onclick="runExample1()">è¿è¡Œä¾‹é¢˜1</button>
            <button onclick="showAnswer1()" class="practice-btn">æŸ¥çœ‹è¯¦è§£</button>
            <div id="answer1" style="display:none;" class="output">
                <h4>è¾“å‡ºé¡ºåºï¼š1 â†’ 4 â†’ 3 â†’ 2</h4>
                <p><strong>è§£ææ­¥éª¤ï¼š</strong></p>
                <ol>
                    <li>æ‰§è¡ŒåŒæ­¥ä»£ç ï¼šæ‰“å° <code>1</code></li>
                    <li>é‡åˆ° setTimeoutï¼ˆå®ä»»åŠ¡ï¼‰ï¼Œæ”¾å…¥å®ä»»åŠ¡é˜Ÿåˆ—</li>
                    <li>é‡åˆ° Promise.thenï¼ˆå¾®ä»»åŠ¡ï¼‰ï¼Œæ”¾å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
                    <li>æ‰§è¡ŒåŒæ­¥ä»£ç ï¼šæ‰“å° <code>4</code></li>
                    <li>åŒæ­¥ä»£ç æ‰§è¡Œå®Œï¼Œæ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ‰§è¡Œæ‰“å° <code>3</code></li>
                    <li>å¾®ä»»åŠ¡é˜Ÿåˆ—æ¸…ç©ºï¼Œæ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ï¼Œæ‰“å° <code>2</code></li>
                </ol>
            </div>
        </div>

        <!-- ä¾‹é¢˜2 -->
        <div class="example">
            <h3>ä¾‹é¢˜2ï¼šPromiseæ„é€ å‡½æ•°ï¼ˆæ˜“é”™ç‚¹ï¼‰</h3>
            <div class="code-block">
<pre>console.log('start');

new Promise((resolve) => {
    console.log('promise1');
    resolve();
    console.log('promise2');
}).then(() => {
    console.log('then');
});

console.log('end');</pre>
            </div>
            <button onclick="runExample2()">è¿è¡Œä¾‹é¢˜2</button>
            <button onclick="showAnswer2()" class="practice-btn">æŸ¥çœ‹è¯¦è§£</button>
            <div id="answer2" style="display:none;" class="output">
                <h4>è¾“å‡ºé¡ºåºï¼šstart â†’ promise1 â†’ promise2 â†’ end â†’ then</h4>
                <p><strong>è§£ææ­¥éª¤ï¼š</strong></p>
                <ol>
                    <li>åŒæ­¥ä»£ç ï¼šæ‰“å° <code>start</code></li>
                    <li><strong>âš ï¸ å…³é”®ï¼š</strong>Promiseæ„é€ å‡½æ•°å†…çš„ä»£ç æ˜¯<strong>åŒæ­¥æ‰§è¡Œ</strong>çš„ï¼æ‰“å° <code>promise1</code></li>
                    <li>æ‰§è¡Œ resolve()ï¼ˆåªæ˜¯æ”¹å˜çŠ¶æ€ï¼Œä¸ä¼šç«‹å³æ‰§è¡Œthenï¼‰</li>
                    <li>ç»§ç»­åŒæ­¥ä»£ç ï¼šæ‰“å° <code>promise2</code></li>
                    <li>thenå›è°ƒï¼ˆå¾®ä»»åŠ¡ï¼‰æ”¾å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
                    <li>åŒæ­¥ä»£ç ï¼šæ‰“å° <code>end</code></li>
                    <li>åŒæ­¥ä»£ç æ‰§è¡Œå®Œï¼Œæ‰§è¡Œå¾®ä»»åŠ¡ï¼šæ‰“å° <code>then</code></li>
                </ol>
            </div>
        </div>

        <!-- ä¾‹é¢˜3 -->
        <div class="example">
            <h3>ä¾‹é¢˜3ï¼šå¤šä¸ªå®šæ—¶å™¨å’ŒPromiseï¼ˆè¿›é˜¶ï¼‰</h3>
            <div class="code-block">
<pre>setTimeout(() => {
    console.log('timeout1');
    Promise.resolve().then(() => {
        console.log('promise1');
    });
}, 0);

setTimeout(() => {
    console.log('timeout2');
}, 0);

Promise.resolve().then(() => {
    console.log('promise2');
});

console.log('sync');</pre>
            </div>
            <button onclick="runExample3()">è¿è¡Œä¾‹é¢˜3</button>
            <button onclick="showAnswer3()" class="practice-btn">æŸ¥çœ‹è¯¦è§£</button>
            <div id="answer3" style="display:none;" class="output">
                <h4>è¾“å‡ºé¡ºåºï¼šsync â†’ promise2 â†’ timeout1 â†’ promise1 â†’ timeout2</h4>
                <p><strong>è§£ææ­¥éª¤ï¼ˆç”»å›¾ç†è§£ï¼‰ï¼š</strong></p>
                <ol>
                    <li>åŒæ­¥ä»£ç ï¼šæ‰“å° <code>sync</code></li>
                    <li>å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼š[promise2]ï¼Œå®ä»»åŠ¡é˜Ÿåˆ—ï¼š[timeout1, timeout2]</li>
                    <li>æ‰§è¡Œå¾®ä»»åŠ¡ï¼šæ‰“å° <code>promise2</code></li>
                    <li>æ‰§è¡Œç¬¬ä¸€ä¸ªå®ä»»åŠ¡ï¼šæ‰“å° <code>timeout1</code>ï¼Œäº§ç”Ÿæ–°å¾®ä»»åŠ¡ promise1</li>
                    <li><strong>âš ï¸ å…³é”®ï¼š</strong>ç«‹å³æ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ‰§è¡Œæ‰“å° <code>promise1</code></li>
                    <li>æ‰§è¡Œç¬¬äºŒä¸ªå®ä»»åŠ¡ï¼šæ‰“å° <code>timeout2</code></li>
                </ol>
            </div>
        </div>

        <!-- ä¾‹é¢˜4 -->
        <div class="example">
            <h3>ä¾‹é¢˜4ï¼šasync/awaitï¼ˆé«˜é¢‘è€ƒç‚¹ï¼‰</h3>
            <div class="code-block">
<pre>async function async1() {
    console.log('async1 start');
    await async2();
    console.log('async1 end');
}

async function async2() {
    console.log('async2');
}

console.log('script start');

setTimeout(() => {
    console.log('setTimeout');
}, 0);

async1();

new Promise((resolve) => {
    console.log('promise1');
    resolve();
}).then(() => {
    console.log('promise2');
});

console.log('script end');</pre>
            </div>
            <button onclick="runExample4()">è¿è¡Œä¾‹é¢˜4</button>
            <button onclick="showAnswer4()" class="practice-btn">æŸ¥çœ‹è¯¦è§£</button>
            <div id="answer4" style="display:none;" class="output">
                <h4>è¾“å‡ºé¡ºåºï¼šscript start â†’ async1 start â†’ async2 â†’ promise1 â†’ script end â†’ async1 end â†’ promise2 â†’ setTimeout</h4>
                <p><strong>è§£ææ­¥éª¤ï¼ˆé‡ç‚¹ç†è§£ awaitï¼‰ï¼š</strong></p>
                <ol>
                    <li>åŒæ­¥ä»£ç ï¼šæ‰“å° <code>script start</code></li>
                    <li>setTimeout æ”¾å…¥å®ä»»åŠ¡é˜Ÿåˆ—</li>
                    <li>è°ƒç”¨ async1()ï¼Œæ‰“å° <code>async1 start</code></li>
                    <li>æ‰§è¡Œ await async2()ï¼Œè¿›å…¥ async2ï¼Œæ‰“å° <code>async2</code></li>
                    <li><strong>âš ï¸ å…³é”®ï¼š</strong>await åé¢çš„ä»£ç ï¼ˆasync1 endï¼‰ç›¸å½“äºæ”¾å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
                    <li>Promiseæ„é€ å‡½æ•°åŒæ­¥æ‰§è¡Œï¼šæ‰“å° <code>promise1</code></li>
                    <li>thenå›è°ƒæ”¾å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
                    <li>åŒæ­¥ä»£ç ï¼šæ‰“å° <code>script end</code></li>
                    <li>å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼š[async1 end, promise2]ï¼Œä¾æ¬¡æ‰§è¡Œ</li>
                    <li>æœ€åæ‰§è¡Œå®ä»»åŠ¡ï¼šæ‰“å° <code>setTimeout</code></li>
                </ol>
                <div class="warning">
                    <strong>await çš„æœ¬è´¨ï¼š</strong>
                    <code>await xxx</code> ç›¸å½“äº <code>Promise.resolve(xxx).then(...)</code>
                    <br>æ‰€ä»¥ await åé¢çš„ä»£ç ä¼šè¢«å½“ä½œå¾®ä»»åŠ¡å¤„ç†
                </div>
            </div>
        </div>

        <!-- ä¾‹é¢˜5 -->
        <div class="example">
            <h3>ä¾‹é¢˜5ï¼šç»¼åˆç»ƒä¹ ï¼ˆé¢è¯•éš¾åº¦ï¼‰</h3>
            <div class="code-block">
<pre>console.log('1');

setTimeout(() => {
    console.log('2');
    Promise.resolve().then(() => {
        console.log('3');
    });
});

new Promise((resolve, reject) => {
    console.log('4');
    resolve('5');
}).then((data) => {
    console.log(data);
    
    Promise.resolve().then(() => {
        console.log('6');
    }).then(() => {
        console.log('7');
        
        setTimeout(() => {
            console.log('8');
        }, 0);
    });
});

setTimeout(() => {
    console.log('9');
});

console.log('10');</pre>
            </div>
            <button onclick="runExample5()">è¿è¡Œä¾‹é¢˜5</button>
            <button onclick="showAnswer5()" class="practice-btn">æŸ¥çœ‹è¯¦è§£</button>
            <div id="answer5" style="display:none;" class="output">
                <h4>è¾“å‡ºé¡ºåºï¼š1 â†’ 4 â†’ 10 â†’ 5 â†’ 6 â†’ 7 â†’ 2 â†’ 3 â†’ 9 â†’ 8</h4>
                <p><strong>è§£ææ­¥éª¤ï¼ˆå»ºè®®ç”»å›¾ï¼‰ï¼š</strong></p>
                <ol>
                    <li>åŒæ­¥ï¼š<code>1</code></li>
                    <li>setTimeoutæ”¾å…¥å®ä»»åŠ¡é˜Ÿåˆ—</li>
                    <li>Promiseæ„é€ å‡½æ•°åŒæ­¥æ‰§è¡Œï¼š<code>4</code></li>
                    <li>thenæ”¾å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
                    <li>setTimeoutæ”¾å…¥å®ä»»åŠ¡é˜Ÿåˆ—</li>
                    <li>åŒæ­¥ï¼š<code>10</code></li>
                    <li>æ‰§è¡Œå¾®ä»»åŠ¡æ‰“å° <code>5</code>ï¼Œäº§ç”Ÿæ–°çš„å¾®ä»»åŠ¡é“¾</li>
                    <li>å¾®ä»»åŠ¡ <code>6</code></li>
                    <li>å¾®ä»»åŠ¡ <code>7</code>ï¼Œäº§ç”Ÿæ–°çš„å®ä»»åŠ¡</li>
                    <li>æ‰§è¡Œç¬¬ä¸€ä¸ªå®ä»»åŠ¡ï¼š<code>2</code>ï¼Œäº§ç”Ÿå¾®ä»»åŠ¡ <code>3</code></li>
                    <li>ç«‹å³æ‰§è¡Œå¾®ä»»åŠ¡ï¼š<code>3</code></li>
                    <li>æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡ï¼š<code>9</code></li>
                    <li>æ‰§è¡Œæœ€åçš„å®ä»»åŠ¡ï¼š<code>8</code></li>
                </ol>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ¯ å››ã€è§£é¢˜æŠ€å·§æ€»ç»“</h2>
        
        <div class="key-point">
            <h3>ğŸ“ ä¸‰æ­¥è§£é¢˜æ³•ï¼ˆæ¨èï¼‰ï¼š</h3>
            <ol style="font-size: 16px; line-height: 1.8;">
                <li><strong>ç¬¬ä¸€æ­¥ï¼šæ ‡è®°ä»£ç ç±»å‹</strong>
                    <ul>
                        <li>ç”¨ä¸åŒé¢œè‰²æˆ–ç¬¦å·æ ‡è®°ï¼šåŒæ­¥(S)ã€å¾®ä»»åŠ¡(Mi)ã€å®ä»»åŠ¡(Ma)</li>
                    </ul>
                </li>
                <li><strong>ç¬¬äºŒæ­¥ï¼šç”»ä¸‰ä¸ªé˜Ÿåˆ—</strong>
                    <ul>
                        <li>æ‰§è¡Œæ ˆï¼ˆåŒæ­¥ä»£ç ï¼‰</li>
                        <li>å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
                        <li>å®ä»»åŠ¡é˜Ÿåˆ—</li>
                    </ul>
                </li>
                <li><strong>ç¬¬ä¸‰æ­¥ï¼šæŒ‰è§„åˆ™æ‰§è¡Œ</strong>
                    <ul>
                        <li>æ‰§è¡Œæ ˆæ¸…ç©º â†’ æ¸…ç©ºå¾®ä»»åŠ¡é˜Ÿåˆ— â†’ æ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ â†’ å¾ªç¯</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="warning">
            <h3>âš ï¸ å¸¸è§é”™è¯¯ç‚¹ï¼š</h3>
            <ol>
                <li><strong>è¯¯è®¤ä¸º Promise æ„é€ å‡½æ•°æ˜¯å¼‚æ­¥çš„</strong> - å®é™…æ˜¯åŒæ­¥çš„ï¼</li>
                <li><strong>å¿˜è®° await åçš„ä»£ç æ˜¯å¾®ä»»åŠ¡</strong> - await ç­‰ä»·äº .then()</li>
                <li><strong>ä»¥ä¸ºå®ä»»åŠ¡ä¼šä¸€æ¬¡æ€§æ‰§è¡Œå®Œ</strong> - å®é™…æ¯æ¬¡åªæ‰§è¡Œä¸€ä¸ª</li>
                <li><strong>å¿½ç•¥å¾®ä»»åŠ¡ä¸­äº§ç”Ÿçš„æ–°å¾®ä»»åŠ¡</strong> - ä¼šåœ¨å½“å‰è½®æ¬¡ç»§ç»­æ‰§è¡Œ</li>
                <li><strong>setTimeout(fn, 0) ä¸æ˜¯ç«‹å³æ‰§è¡Œ</strong> - å®ƒæ˜¯å®ä»»åŠ¡ï¼Œæ’åœ¨å¾®ä»»åŠ¡ä¹‹å</li>
            </ol>
        </div>
    </div>

    <div class="section">
        <h2>ğŸƒ äº”ã€ç»ƒä¹ é¢˜ï¼ˆè‡ªæµ‹ï¼‰</h2>
        
        <div class="example">
            <h3>ç»ƒä¹ é¢˜1ï¼š</h3>
            <div class="code-block">
<pre>Promise.resolve().then(() => {
    console.log('Promise1');
    setTimeout(() => {
        console.log('setTimeout2');
    }, 0);
});

setTimeout(() => {
    console.log('setTimeout1');
    Promise.resolve().then(() => {
        console.log('Promise2');
    });
}, 0);</pre>
            </div>
            <button onclick="runPractice1()">è¿è¡Œç»ƒä¹ 1</button>
            <button onclick="showPracticeAnswer1()" class="practice-btn">æŸ¥çœ‹ç­”æ¡ˆ</button>
            <div id="practiceAnswer1" style="display:none;" class="output">
                <h4>ç­”æ¡ˆï¼šPromise1 â†’ setTimeout1 â†’ Promise2 â†’ setTimeout2</h4>
            </div>
        </div>

        <div class="example">
            <h3>ç»ƒä¹ é¢˜2ï¼š</h3>
            <div class="code-block">
<pre>async function async1() {
    console.log('async1 start');
    await async2();
    console.log('async1 end');
}

async function async2() {
    console.log('async2');
}

console.log('script start');

setTimeout(() => {
    console.log('setTimeout');
}, 0);

async1();

new Promise(resolve => {
    console.log('promise1');
    resolve();
}).then(() => {
    console.log('promise2');
}).then(() => {
    console.log('promise3');
});

console.log('script end');</pre>
            </div>
            <button onclick="runPractice2()">è¿è¡Œç»ƒä¹ 2</button>
            <button onclick="showPracticeAnswer2()" class="practice-btn">æŸ¥çœ‹ç­”æ¡ˆ</button>
            <div id="practiceAnswer2" style="display:none;" class="output">
                <h4>ç­”æ¡ˆï¼šscript start â†’ async1 start â†’ async2 â†’ promise1 â†’ script end â†’ async1 end â†’ promise2 â†’ promise3 â†’ setTimeout</h4>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ“š å…­ã€è®°å¿†å£è¯€</h2>
        <div class="key-point" style="font-size: 18px; text-align: center; padding: 30px;">
            <p><strong>åŒæ­¥ä»»åŠ¡å…ˆæ‰§è¡Œï¼Œ</strong></p>
            <p><strong>å¾®ä»»åŠ¡ç´§è·Ÿåï¼Œ</strong></p>
            <p><strong>å®ä»»åŠ¡æ’æœ€åã€‚</strong></p>
            <p style="margin-top: 20px;"><strong>Promiseæ„é€ åŒæ­¥è·‘ï¼Œ</strong></p>
            <p><strong>then/catch/awaitéƒ½æ˜¯å¾®ï¼Œ</strong></p>
            <p><strong>å®šæ—¶å™¨éƒ½æ˜¯å®ã€‚</strong></p>
            <p style="margin-top: 20px; color: #d32f2f;"><strong>å¾®ä»»åŠ¡æ¸…ç©ºå†å®ä»»åŠ¡ï¼Œ</strong></p>
            <p style="color: #d32f2f;"><strong>å®ä»»åŠ¡æ¯æ¬¡åªä¸€ä¸ªï¼</strong></p>
        </div>
    </div>

    <script>
        // ä¾‹é¢˜1
        function runExample1() {
            console.clear();
            console.log('=== å¼€å§‹æ‰§è¡Œä¾‹é¢˜1 ===');
            
            console.log('1');

            setTimeout(() => {
                console.log('2');
            }, 0);

            Promise.resolve().then(() => {
                console.log('3');
            });

            console.log('4');
        }

        function showAnswer1() {
            document.getElementById('answer1').style.display = 'block';
        }

        // ä¾‹é¢˜2
        function runExample2() {
            console.clear();
            console.log('=== å¼€å§‹æ‰§è¡Œä¾‹é¢˜2 ===');
            
            console.log('start');

            new Promise((resolve) => {
                console.log('promise1');
                resolve();
                console.log('promise2');
            }).then(() => {
                console.log('then');
            });

            console.log('end');
        }

        function showAnswer2() {
            document.getElementById('answer2').style.display = 'block';
        }

        // ä¾‹é¢˜3
        function runExample3() {
            console.clear();
            console.log('=== å¼€å§‹æ‰§è¡Œä¾‹é¢˜3 ===');
            
            setTimeout(() => {
                console.log('timeout1');
                Promise.resolve().then(() => {
                    console.log('promise1');
                });
            }, 0);

            setTimeout(() => {
                console.log('timeout2');
            }, 0);

            Promise.resolve().then(() => {
                console.log('promise2');
            });

            console.log('sync');
        }

        function showAnswer3() {
            document.getElementById('answer3').style.display = 'block';
        }

        // ä¾‹é¢˜4
        function runExample4() {
            console.clear();
            console.log('=== å¼€å§‹æ‰§è¡Œä¾‹é¢˜4 ===');
            
            async function async1() {
                console.log('async1 start');
                await async2();
                console.log('async1 end');
            }

            async function async2() {
                console.log('async2');
            }

            console.log('script start');

            setTimeout(() => {
                console.log('setTimeout');
            }, 0);

            async1();

            new Promise((resolve) => {
                console.log('promise1');
                resolve();
            }).then(() => {
                console.log('promise2');
            });

            console.log('script end');
        }

        function showAnswer4() {
            document.getElementById('answer4').style.display = 'block';
        }

        // ä¾‹é¢˜5
        function runExample5() {
            console.clear();
            console.log('=== å¼€å§‹æ‰§è¡Œä¾‹é¢˜5 ===');
            
            console.log('1');

            setTimeout(() => {
                console.log('2');
                Promise.resolve().then(() => {
                    console.log('3');
                });
            });

            new Promise((resolve, reject) => {
                console.log('4');
                resolve('5');
            }).then((data) => {
                console.log(data);
                
                Promise.resolve().then(() => {
                    console.log('6');
                }).then(() => {
                    console.log('7');
                    
                    setTimeout(() => {
                        console.log('8');
                    }, 0);
                });
            });

            setTimeout(() => {
                console.log('9');
            });

            console.log('10');
        }

        function showAnswer5() {
            document.getElementById('answer5').style.display = 'block';
        }

        // ç»ƒä¹ é¢˜1
        function runPractice1() {
            console.clear();
            console.log('=== å¼€å§‹æ‰§è¡Œç»ƒä¹ 1 ===');
            
            Promise.resolve().then(() => {
                console.log('Promise1');
                setTimeout(() => {
                    console.log('setTimeout2');
                }, 0);
            });

            setTimeout(() => {
                console.log('setTimeout1');
                Promise.resolve().then(() => {
                    console.log('Promise2');
                });
            }, 0);
        }

        function showPracticeAnswer1() {
            document.getElementById('practiceAnswer1').style.display = 'block';
        }

        // ç»ƒä¹ é¢˜2
        function runPractice2() {
            console.clear();
            console.log('=== å¼€å§‹æ‰§è¡Œç»ƒä¹ 2 ===');
            
            async function async1() {
                console.log('async1 start');
                await async2();
                console.log('async1 end');
            }

            async function async2() {
                console.log('async2');
            }

            console.log('script start');

            setTimeout(() => {
                console.log('setTimeout');
            }, 0);

            async1();

            new Promise(resolve => {
                console.log('promise1');
                resolve();
            }).then(() => {
                console.log('promise2');
            }).then(() => {
                console.log('promise3');
            });

            console.log('script end');
        }

        function showPracticeAnswer2() {
            document.getElementById('practiceAnswer2').style.display = 'block';
        }

        // é¡µé¢åŠ è½½æç¤º
        console.log('%cæ¬¢è¿å­¦ä¹ å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ï¼', 'color: #4CAF50; font-size: 20px; font-weight: bold;');
        console.log('%cæ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹æ‰§è¡Œç»“æœ', 'color: #2196F3; font-size: 14px;');

        // ========== Promise åµŒå¥—æµ‹è¯•å‡½æ•° ==========
        function testPromiseNested1() {
            console.clear();
            console.log('%c========== ä¾‹é¢˜1ï¼šç»å…¸åµŒå¥— Promise ==========', 'color: #4CAF50; font-size: 16px; font-weight: bold;');
            
            console.log('start');

            new Promise((resolve) => {
                console.log('promise1');
                resolve();
            })
            .then(() => {
                console.log('then1');
                return new Promise((resolve) => {
                    console.log('promise2');
                    resolve();
                })
                .then(() => {
                    console.log('then2');
                });
            })
            .then(() => {
                console.log('then3');
            });

            console.log('end');
        }

        function testPromiseNested2() {
            console.clear();
            console.log('%c========== ä¾‹é¢˜2ï¼šä¸ return Promise ==========', 'color: #FF9800; font-size: 16px; font-weight: bold;');
            
            console.log('start');

            new Promise((resolve) => {
                console.log('promise1');
                resolve();
            })
            .then(() => {
                console.log('then1');
                // âŒ æ³¨æ„ï¼šæ²¡æœ‰ returnï¼
                new Promise((resolve) => {
                    console.log('promise2');
                    resolve();
                })
                .then(() => {
                    console.log('then2');
                });
            })
            .then(() => {
                console.log('then3');
            });

            console.log('end');
        }

        function testPromiseNested3() {
            console.clear();
            console.log('%c========== ä¾‹é¢˜3ï¼šå¤šå±‚åµŒå¥— ==========', 'color: #2196F3; font-size: 16px; font-weight: bold;');
            
            Promise.resolve()
              .then(() => {
                  console.log('then1');
                  return Promise.resolve()
                      .then(() => {
                          console.log('then2');
                      })
                      .then(() => {
                          console.log('then3');
                      });
              })
              .then(() => {
                  console.log('then4');
              });

            Promise.resolve()
              .then(() => {
                  console.log('then5');
              })
              .then(() => {
                  console.log('then6');
              });
        }
    </script>

    <!-- ========== æ–°å¢ï¼šPromise åµŒå¥—ä¸ then æ‰§è¡Œé¡ºåºï¼ˆæ ¸å¿ƒé‡ç‚¹ï¼‰ ========== -->
    <div class="section">
        <h2>ğŸ¯ Promise åµŒå¥—ä¸ then çš„æ‰§è¡Œé¡ºåºï¼ˆé«˜é¢‘è€ƒç‚¹ï¼‰</h2>
        
        <div class="key-point">
            <h3>âš ï¸ ä¸ºä»€ä¹ˆè¦è®²è¿™ä¸ªï¼Ÿ</h3>
            <p style="font-size: 16px; line-height: 1.8;">
                <strong>è¿™æ˜¯å®ä»»åŠ¡å¾®ä»»åŠ¡ä¸­æœ€å®¹æ˜“å‡ºé”™çš„éƒ¨åˆ†ï¼</strong><br>
                å¾ˆå¤šäººä»¥ä¸ºå¾®ä»»åŠ¡éƒ½æ˜¯æŒ‰é¡ºåºæ‰§è¡Œï¼Œä½† <strong>Promise é“¾å¼è°ƒç”¨æ—¶ï¼Œæ‰§è¡Œé¡ºåºå—è¿”å›å€¼å½±å“</strong>ã€‚<br>
                è¿™ä¸ä»…æ˜¯é¢è¯•é«˜é¢‘é¢˜ï¼Œä¹Ÿæ˜¯å®é™…å¼€å‘ä¸­å®¹æ˜“å‡º Bug çš„åœ°æ–¹ï¼
            </p>
        </div>

        <h3>æ ¸å¿ƒåŸç†ï¼š.then() è¿”å›å€¼çš„å½±å“</h3>
        <div class="code-block">
<pre><strong>è§„åˆ™1ï¼š.then() è¿”å›æ™®é€šå€¼</strong>
Promise.resolve()
  .then(() => {
      return 'hello';  // è¿”å›æ™®é€šå€¼
  })
  .then((value) => {
      console.log(value);  // ä¸‹ä¸€ä¸ªå¾®ä»»åŠ¡ç«‹å³æ‰§è¡Œ
  });

<strong>è§„åˆ™2ï¼š.then() è¿”å› Promise</strong>
Promise.resolve()
  .then(() => {
      return new Promise(resolve => {  // è¿”å› Promise
          resolve();
      }).then(() => {
          console.log('inner');
      });
  })
  .then(() => {
      console.log('outer');  // å¿…é¡»ç­‰ inner å®Œæˆï¼
  });

// è¾“å‡ºï¼šinner â†’ outer</pre>
        </div>

        <h3>ä¾‹é¢˜1ï¼šç»å…¸çš„åµŒå¥— Promiseï¼ˆå¿…è€ƒï¼‰</h3>
        <div class="code-block">
<pre>console.log('start');

new Promise((resolve) => {
    console.log('promise1');
    resolve();
})
.then(() => {
    console.log('then1');
    return new Promise((resolve) => {
        console.log('promise2');
        resolve();
    })
    .then(() => {
        console.log('then2');
    });
})
.then(() => {
    console.log('then3');
});

console.log('end');</pre>
        </div>

        <button onclick="testPromiseNested1()" style="font-size: 16px; padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 10px 0;">
            ğŸš€ è¿è¡Œä¾‹é¢˜1ï¼ˆæ‰“å¼€æ§åˆ¶å°æŸ¥çœ‹ç»“æœï¼‰
        </button>

        <div class="output">
            <h4>è¾“å‡ºé¡ºåºï¼š</h4>
            <pre>start
promise1
end
then1
promise2
then2
then3</pre>
        </div>

        <div class="explanation">
            <h4>è¯¦ç»†åˆ†æï¼š</h4>
            <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">
                <thead>
                    <tr style="background: #2196F3; color: white;">
                        <th style="padding: 10px; border: 1px solid #ddd;">æ­¥éª¤</th>
                        <th style="padding: 10px; border: 1px solid #ddd;">æ‰§è¡Œå†…å®¹</th>
                        <th style="padding: 10px; border: 1px solid #ddd;">å¾®ä»»åŠ¡é˜Ÿåˆ—</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">1</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">æ‰“å° <code>start</code>ï¼ˆåŒæ­¥ï¼‰</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">[]</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">2</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Promise æ„é€ å‡½æ•°ï¼Œæ‰“å° <code>promise1</code></td>
                        <td style="padding: 8px; border: 1px solid #ddd;">[]</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">3</td>
                        <td style="padding: 8px; border: 1px solid #ddd;"><code>resolve()</code>ï¼Œç¬¬ä¸€ä¸ª then è¿›é˜Ÿ</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">[then1]</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">4</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">æ‰“å° <code>end</code>ï¼ˆåŒæ­¥ï¼‰</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">[then1]</td>
                    </tr>
                    <tr style="background: #e3f2fd;">
                        <td style="padding: 8px; border: 1px solid #ddd;">5</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">æ‰§è¡Œå¾®ä»»åŠ¡ then1ï¼Œæ‰“å° <code>then1</code></td>
                        <td style="padding: 8px; border: 1px solid #ddd;">[]</td>
                    </tr>
                    <tr style="background: #e3f2fd;">
                        <td style="padding: 8px; border: 1px solid #ddd;">6</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">åˆ›å»ºæ–° Promiseï¼Œæ‰“å° <code>promise2</code></td>
                        <td style="padding: 8px; border: 1px solid #ddd;">[]</td>
                    </tr>
                    <tr style="background: #e3f2fd;">
                        <td style="padding: 8px; border: 1px solid #ddd;">7</td>
                        <td style="padding: 8px; border: 1px solid #ddd;"><code>resolve()</code>ï¼Œthen2 è¿›é˜Ÿ</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">[then2]</td>
                    </tr>
                    <tr style="background: #fff3e0;">
                        <td style="padding: 8px; border: 1px solid #ddd;">8</td>
                        <td style="padding: 8px; border: 1px solid #ddd;"><strong>âš ï¸ å…³é”®ï¼š</strong>ç¬¬ä¸€ä¸ª then è¿”å›äº† Promise é“¾<br>then3 å¿…é¡»ç­‰è¿™ä¸ªé“¾å®Œæˆ</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">[then2]</td>
                    </tr>
                    <tr style="background: #e8f5e9;">
                        <td style="padding: 8px; border: 1px solid #ddd;">9</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">æ‰§è¡Œå¾®ä»»åŠ¡ then2ï¼Œæ‰“å° <code>then2</code></td>
                        <td style="padding: 8px; border: 1px solid #ddd;">[]</td>
                    </tr>
                    <tr style="background: #e8f5e9;">
                        <td style="padding: 8px; border: 1px solid #ddd;">10</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">Promise é“¾å®Œæˆï¼Œthen3 è¿›é˜Ÿ</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">[then3]</td>
                    </tr>
                    <tr style="background: #e8f5e9;">
                        <td style="padding: 8px; border: 1px solid #ddd;">11</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">æ‰§è¡Œå¾®ä»»åŠ¡ then3ï¼Œæ‰“å° <code>then3</code></td>
                        <td style="padding: 8px; border: 1px solid #ddd;">[]</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3>ä¾‹é¢˜2ï¼šå¦‚æœä¸ return Promise ä¼šæ€æ ·ï¼Ÿ</h3>
        <div class="code-block">
<pre>console.log('start');

new Promise((resolve) => {
    console.log('promise1');
    resolve();
})
.then(() => {
    console.log('then1');
    // âŒ æ³¨æ„ï¼šæ²¡æœ‰ returnï¼
    new Promise((resolve) => {
        console.log('promise2');
        resolve();
    })
    .then(() => {
        console.log('then2');
    });
})
.then(() => {
    console.log('then3');
});

console.log('end');</pre>
        </div>

        <button onclick="testPromiseNested2()" style="font-size: 16px; padding: 10px 20px; background: #FF9800; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 10px 0;">
            ğŸš€ è¿è¡Œä¾‹é¢˜2ï¼ˆæ—  return çš„æƒ…å†µï¼‰
        </button>

        <div class="output">
            <h4>è¾“å‡ºé¡ºåºï¼š</h4>
            <pre>start
promise1
end
then1
promise2
then2
then3</pre>
            <p style="color: #FF9800; font-weight: bold;">æ³¨æ„ï¼šé¡ºåºå’Œä¾‹é¢˜1ç›¸åŒï¼</p>
        </div>

        <div class="explanation">
            <h4>âš ï¸ é‡è¦å‘ç°ï¼šreturn ä¸å½±å“é¡ºåºï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼‰</h4>
            <ul style="font-size: 16px; line-height: 1.8;">
                <li><strong>è™½ç„¶æ²¡æœ‰ return Promise</strong>ï¼Œä½†è¾“å‡ºé¡ºåºå’Œä¾‹é¢˜1å®Œå…¨ç›¸åŒ</li>
                <li><strong>åŸå› ï¼š.then() çš„æ³¨å†Œæ—¶æœºå†³å®šæ‰§è¡Œé¡ºåº</strong>
                    <ul>
                        <li>æ‰§è¡Œ then1 æ—¶ï¼Œå†…éƒ¨åˆ›å»ºæ–° Promise å¹¶ç«‹å³ resolve</li>
                        <li>å†…éƒ¨çš„ then2 ç«‹å³æ³¨å†Œè¿›å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
                        <li>ç¬¬ä¸€ä¸ª .then è¿”å› undefinedï¼Œthen3 ä¹Ÿæ³¨å†Œè¿›å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
                        <li>ä½† then2 å…ˆæ³¨å†Œï¼Œæ‰€ä»¥å…ˆæ‰§è¡Œ</li>
                    </ul>
                </li>
                <li><strong>å¯¹æ¯”ä¾‹é¢˜1ï¼ˆæœ‰ returnï¼‰ï¼š</strong>
                    <ul>
                        <li>ä¾‹é¢˜1ï¼šreturn Promise â†’ then3 ç­‰å¾…æ•´ä¸ª Promise é“¾</li>
                        <li>ä¾‹é¢˜2ï¼šä¸ return â†’ then3 ä¸ç­‰å¾…ï¼Œä½†å› ä¸º then2 å…ˆæ³¨å†Œï¼Œä»ç„¶å…ˆæ‰§è¡Œ</li>
                        <li><strong>ç»“æœï¼šä¸¤ç§æƒ…å†µé¡ºåºç›¸åŒï¼</strong></li>
                    </ul>
                </li>
                <li><strong>ç»“è®ºï¼š</strong>åœ¨è¿™ä¸ªç‰¹å®šåœºæ™¯ä¸­ï¼Œreturn ä¸æ”¹å˜æ‰§è¡Œé¡ºåº</li>
            </ul>
        </div>

        <h3>ä¾‹é¢˜3ï¼šå¤šå±‚åµŒå¥—ï¼ˆéš¾åº¦å‡çº§ï¼‰</h3>
        <div class="code-block">
<pre>Promise.resolve()
  .then(() => {
      console.log('then1');
      return Promise.resolve()
          .then(() => {
              console.log('then2');
          })
          .then(() => {
              console.log('then3');
          });
  })
  .then(() => {
      console.log('then4');
  });

Promise.resolve()
  .then(() => {
      console.log('then5');
  })
  .then(() => {
      console.log('then6');
  });</pre>
        </div>

        <button onclick="testPromiseNested3()" style="font-size: 16px; padding: 10px 20px; background: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 10px 0;">
            ğŸš€ è¿è¡Œä¾‹é¢˜3ï¼ˆå¤šä¸ª Promise é“¾äº¤æ›¿æ‰§è¡Œï¼‰
        </button>

        <div class="output">
            <h4>è¾“å‡ºé¡ºåºï¼š</h4>
            <pre>then1
then5
then2
then6
then3
then4</pre>
        </div>

        <div class="explanation">
            <h4>æ‰§è¡Œè¿‡ç¨‹ï¼š</h4>
            <ol style="font-size: 16px; line-height: 1.8;">
                <li><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼š</strong>[then1, then5]</li>
                <li>æ‰§è¡Œ then1ï¼Œè¾“å‡º <code>then1</code>ï¼Œè¿”å› Promise é“¾</li>
                <li><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼š</strong>[then5, then2]</li>
                <li>æ‰§è¡Œ then5ï¼Œè¾“å‡º <code>then5</code></li>
                <li><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼š</strong>[then2, then6]</li>
                <li>æ‰§è¡Œ then2ï¼Œè¾“å‡º <code>then2</code></li>
                <li><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼š</strong>[then6, then3]</li>
                <li>æ‰§è¡Œ then6ï¼Œè¾“å‡º <code>then6</code></li>
                <li><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼š</strong>[then3]</li>
                <li>æ‰§è¡Œ then3ï¼Œè¾“å‡º <code>then3</code>ï¼ŒPromise é“¾å®Œæˆ</li>
                <li><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼š</strong>[then4]</li>
                <li>æ‰§è¡Œ then4ï¼Œè¾“å‡º <code>then4</code></li>
            </ol>
        </div>

        <h3>ğŸ“ æ€»ç»“ï¼šé‡è¦è§„åˆ™</h3>
        <div class="key-point">
            <ol style="font-size: 16px; line-height: 2;">
                <li><strong>æ ¸å¿ƒåŸåˆ™ï¼š.then() çš„æ³¨å†Œæ—¶æœºå†³å®šæ‰§è¡Œé¡ºåº</strong>
                    <ul>
                        <li>ä¸æ˜¯ returnï¼Œè€Œæ˜¯ä»€ä¹ˆæ—¶å€™è°ƒç”¨ .then()</li>
                        <li>å…ˆæ³¨å†Œè¿›å¾®ä»»åŠ¡é˜Ÿåˆ—çš„å…ˆæ‰§è¡Œï¼ˆFIFOï¼‰</li>
                    </ul>
                </li>
                <li><strong>.then() è¿”å› Promiseï¼š</strong>
                    <ul>
                        <li>ä¸‹ä¸€ä¸ª .then() å¿…é¡»ç­‰è¿™ä¸ª Promise <strong>åŠå…¶æ‰€æœ‰é“¾å¼ .then()</strong> å®Œæˆ</li>
                        <li>ä¾‹é¢˜1 å’Œä¾‹é¢˜3 å°±æ˜¯è¿™ç§æƒ…å†µ</li>
                    </ul>
                </li>
                <li><strong>.then() ä¸ return æˆ–è¿”å›æ™®é€šå€¼ï¼š</strong>
                    <ul>
                        <li>ä¸‹ä¸€ä¸ª .then() ä¼šç«‹å³æ³¨å†Œè¿›å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
                        <li><strong>ä½†ä¸ä»£è¡¨ç«‹å³æ‰§è¡Œ</strong>ï¼ˆè¿˜è¦çœ‹é˜Ÿåˆ—ä¸­çš„é¡ºåºï¼‰</li>
                        <li>ä¾‹é¢˜2 è¯´æ˜ï¼šå³ä½¿ä¸ returnï¼Œå†…éƒ¨ Promise çš„ .then å¯èƒ½å…ˆæ³¨å†Œï¼Œæ‰€ä»¥å…ˆæ‰§è¡Œ</li>
                    </ul>
                </li>
                <li><strong>å¤šä¸ªç‹¬ç«‹çš„ Promise é“¾ï¼š</strong>
                    <ul>
                        <li>å®ƒä»¬çš„ .then() ä¼šäº¤æ›¿è¿›å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
                        <li>éµå¾ª"å…ˆè¿›å…ˆå‡º"åŸåˆ™</li>
                        <li>ä¾‹é¢˜3 å±•ç¤ºäº†è¿™ç§äº¤æ›¿æ‰§è¡Œ</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="key-point" style="background: #fff3e0; border-left-color: #ff9800;">
            <h3>ğŸ“ é¢è¯•æ ‡å‡†å›ç­”</h3>
            <p><strong>é—®ï¼šä¸ºä»€ä¹ˆ Promise åµŒå¥—æ—¶ï¼Œå†…å±‚ then ä¼šå…ˆäºå¤–å±‚ then æ‰§è¡Œï¼Ÿ</strong></p>
            <p style="color: #d84315; font-weight: bold;">ç­”ï¼š</p>
            <ul style="font-size: 16px; line-height: 1.8;">
                <li>âœ… "å½“ .then() è¿”å›ä¸€ä¸ª Promise æ—¶ï¼Œå¤–å±‚çš„ä¸‹ä¸€ä¸ª .then() å¿…é¡»ç­‰å¾…è¿™ä¸ª Promise å®Œæˆ"</li>
                <li>âœ… "è¿™æ˜¯ Promise/A+ è§„èŒƒè§„å®šçš„ï¼š.then() è¿”å›çš„ Promise ä¼šè¢«'è§£åŒ…'ï¼ˆunwrapï¼‰"</li>
                <li>âœ… "å¦‚æœè¿”å›çš„ Promise è¿˜æœ‰ .then() é“¾ï¼Œæ‰€æœ‰è¿™äº› .then() éƒ½ä¼šä¼˜å…ˆæ‰§è¡Œ"</li>
                <li>âœ… "åªæœ‰å½“æ•´ä¸ªè¿”å›çš„ Promise é“¾å®Œæˆåï¼Œå¤–å±‚çš„ä¸‹ä¸€ä¸ª .then() æ‰ä¼šè¿›å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—"</li>
                <li>âœ… "è¿™ç¡®ä¿äº† Promise é“¾çš„æ­£ç¡®æ‰§è¡Œé¡ºåºï¼Œç¬¦åˆå¼‚æ­¥ç¼–ç¨‹çš„è¯­ä¹‰"</li>
            </ul>
        </div>

        <h3>ğŸ’¡ å®é™…åº”ç”¨åœºæ™¯</h3>
        <div class="code-block">
<pre><strong>åœºæ™¯ï¼šå¤šä¸ªæ¥å£ä¾èµ–è°ƒç”¨</strong>
// âŒ é”™è¯¯å†™æ³•ï¼ˆå¯èƒ½å‡ºç°æ‰§è¡Œé¡ºåºé—®é¢˜ï¼‰
getUserInfo()
  .then(user => {
      getOrders(user.id).then(orders => {
          console.log('orders:', orders);
      });
  })
  .then(() => {
      console.log('done');  // å¯èƒ½åœ¨ orders ä¹‹å‰è¾“å‡ºï¼
  });

// âœ… æ­£ç¡®å†™æ³•
getUserInfo()
  .then(user => {
      return getOrders(user.id);  // return Promise
  })
  .then(orders => {
      console.log('orders:', orders);
  })
  .then(() => {
      console.log('done');  // ä¿è¯åœ¨ orders ä¹‹å
  });</pre>
        </div>
    </div>

</body>
</html>